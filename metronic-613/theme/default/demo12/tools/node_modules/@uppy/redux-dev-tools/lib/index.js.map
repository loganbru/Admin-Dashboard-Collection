{"version":3,"sources":["index.js"],"names":["require","Plugin","module","exports","uppy","opts","type","id","title","defaultOptions","handleStateChange","bind","initDevTools","prevState","nextState","patch","devTools","send","window","devToolsExtension","connect","devToolsUnsubscribe","subscribe","message","payload","reset","computedStates","nextLiftedState","store","state","getState","length","updateAll","JSON","parse","install","withDevTools","__REDUX_DEVTOOLS_EXTENSION__","on","uninstall","off","handleStateUpdate","VERSION"],"mappings":"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","sourcesContent":["const { Plugin } = require('@uppy/core')\n\n/**\n * Add Redux DevTools support to Uppy\n *\n * See https://medium.com/@zalmoxis/redux-devtools-without-redux-or-how-to-have-a-predictable-state-with-any-architecture-61c5f5a7716f\n * and https://github.com/zalmoxisus/mobx-remotedev/blob/master/src/monitorActions.js\n */\nmodule.exports = class ReduxDevTools extends Plugin {\n  static VERSION = require('../package.json').version\n\n  constructor (uppy, opts) {\n    super(uppy, opts)\n    this.type = 'debugger'\n    this.id = this.opts.id || 'ReduxDevTools'\n    this.title = 'Redux DevTools'\n\n    // set default options\n    const defaultOptions = {}\n\n    // merge default options with the ones set by user\n    this.opts = Object.assign({}, defaultOptions, opts)\n\n    this.handleStateChange = this.handleStateChange.bind(this)\n    this.initDevTools = this.initDevTools.bind(this)\n  }\n\n  handleStateChange (prevState, nextState, patch) {\n    this.devTools.send('UPPY_STATE_UPDATE', nextState)\n  }\n\n  initDevTools () {\n    this.devTools = window.devToolsExtension.connect()\n    this.devToolsUnsubscribe = this.devTools.subscribe((message) => {\n      if (message.type === 'DISPATCH') {\n        // Implement monitors actions\n        switch (message.payload.type) {\n          case 'RESET':\n            this.uppy.reset()\n            return\n          case 'IMPORT_STATE': {\n            const computedStates = message.payload.nextLiftedState.computedStates\n            this.uppy.store.state = Object.assign({}, this.uppy.getState(), computedStates[computedStates.length - 1].state)\n            this.uppy.updateAll(this.uppy.getState())\n            return\n          }\n          case 'JUMP_TO_STATE':\n          case 'JUMP_TO_ACTION':\n            this.uppy.store.state = Object.assign({}, this.uppy.getState(), JSON.parse(message.state))\n            this.uppy.updateAll(this.uppy.getState())\n        }\n      }\n    })\n  }\n\n  install () {\n    this.withDevTools = typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__\n    if (this.withDevTools) {\n      this.initDevTools()\n      this.uppy.on('state-update', this.handleStateChange)\n    }\n  }\n\n  uninstall () {\n    if (this.withDevTools) {\n      this.devToolsUnsubscribe()\n      this.uppy.off('state-update', this.handleStateUpdate)\n    }\n  }\n}\n"]}